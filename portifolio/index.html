<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portfólio</title>
  <style>
    :root { --maxw: 1200px; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, Arial, sans-serif; background:#fafafa; color:#222; }
    header {
      position: sticky; top:0; background:#fff; border-bottom:1px solid #eee;
      padding: 12px 16px; display:flex; gap:12px; align-items:center; z-index: 2;
    }
    header a.btn {
      appearance: none; border: none; padding: 10px 14px; border-radius:10px; cursor:pointer;
      background:#111; color:#fff; font-weight:600; text-decoration:none;
    }
    header a.btn:hover { opacity:.9; }
    .wrap { max-width: var(--maxw); margin: 0 auto; padding: 16px; }
    h1 { font-size: 1.4rem; margin: 0; }
    #status { padding: 12px 0; color:#666; }
    .grid {
      display:grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap:12px;
    }
    .card {
      background:#fff; border-radius:12px; overflow:hidden; border:1px solid #eee;
      box-shadow: 0 2px 8px rgba(0,0,0,.05);
    }
    .thumb {
      display:block; width:100%; height: 180px; object-fit:cover; background:#f0f0f0;
      cursor: zoom-in;
    }
    /* Lightbox */
    .lightbox {
      position: fixed; inset:0; background: rgba(0,0,0,.85); display:none; align-items:center; justify-content:center;
      padding: 24px; z-index: 5;
    }
    .lightbox.open { display:flex; }
    .lightbox img {
      max-width: 95vw; max-height: 85vh; display:block;
      border-radius: 10px; box-shadow: 0 8px 30px rgba(0,0,0,.4);
    }
    .lightbox .close {
      position: absolute; top: 10px; right: 10px; font-size: 28px; line-height: 1; color:#fff; cursor:pointer; background:transparent; border:none;
    }
  </style>
</head>
<body>
  <header>
    <a class="btn" href="../index.html">← Voltar</a>
    <h1>Portfólio</h1>
  </header>

  <div class="wrap">
    <div id="status">Carregando fotos…</div>
    <div id="grid" class="grid" hidden></div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-label="Visualizador de imagem">
    <button class="close" aria-label="Fechar">×</button>
    <img id="lightboxImg" alt="">
  </div>

  <script>
    async function loadImages() {
      const statusEl = document.getElementById('status');
      const grid = document.getElementById('grid');

      try {
        const res = await fetch('images.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('Não foi possível carregar images.json');
        const files = await res.json();

        if (!Array.isArray(files) || files.length === 0) {
          statusEl.textContent = 'Nenhuma imagem encontrada. Adicione arquivos ao diretório "portifolio/" e liste-os em images.json.';
          return;
        }

        const frag = document.createDocumentFragment();
        for (const path of files) {
          const card = document.createElement('figure');
          card.className = 'card';

          const img = document.createElement('img');
          img.loading = 'lazy';
          img.decoding = 'async';
          img.src = path;
          img.alt = ''; // acessível mas sem exibir nome
          img.className = 'thumb';
          img.addEventListener('click', () => openLightbox(path, ''));

          card.appendChild(img);
          frag.appendChild(card);
        }
        grid.appendChild(frag);
        grid.hidden = false;
        statusEl.textContent = `${files.length} imagem(ns) carregadas.`;
      } catch (e) {
        console.error(e);
        statusEl.textContent = 'Erro ao carregar a galeria. Verifique se "images.json" existe e está válido.';
      }
    }

    // Lightbox handlers
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lightboxImg');
    function openLightbox(src) {
      lbImg.src = src;
      lb.classList.add('open');
    }
    function closeLightbox() {
      lb.classList.remove('open');
      lbImg.src = '';
    }
    lb.addEventListener('click', (e) => { if (e.target === lb) closeLightbox(); });
    document.querySelector('.lightbox .close').addEventListener('click', closeLightbox);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeLightbox(); });

    loadImages();
  </script>
</body>
</html>
